<ion-content>

  <ion-grid class="mt-2">
    <ion-row>
      <ion-col size="12">
        <ion-text color="primary" class="text-left">
          <h5>
            <strong>Register</strong>
          </h5>
        </ion-text>
      </ion-col>
    </ion-row>

    <ion-row *ngIf="errorMsg">
      <ion-col size="12">
        <p class="text-center text-danger" *ngIf="!errorMsg.status">
          <ion-icon name="alert-circle" color="danger"></ion-icon>
          Error {{ errorMsg }}
        </p>
        <p class="text-center text-danger" *ngIf="errorMsg.status">
          <ion-icon name="alert-circle" color="danger"></ion-icon>
          Error {{ errorMsg.status }} - {{ errorMsg.statusText }}
        </p>
      </ion-col>
    </ion-row>

    <!-- Employee details -->
    <ion-row>
      <ion-col size="12">
        <ion-text color="primary">
          <small><strong>Your Details:</strong></small>
        </ion-text>

        <form novalidate [formGroup]="registerUserForm" class="w-100">
          <ion-row>
            <ion-col size="12">
              <small>
                <strong>Note: </strong>Fields marked with <strong class="text-danger">*</strong> are compulsory.
              </small>
            </ion-col>
            
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  Employee ID
                </ion-label>
                
                <ion-input id="empId" type="text" inputmode="text" class="custom-font" formControlName="empId"></ion-input>
              </ion-item>
  
              <small *ngIf="formErrors.empId" class="text-danger">
                {{ formErrors.empId }}
              </small>
            </ion-col>
            
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  <strong class="text-danger">*</strong>
                  Employee Name
                </ion-label>
  
                <ion-input id="empName" type="text" inputmode="text" class="custom-font" formControlName="empName" autocapitalize="on"></ion-input>
              </ion-item>
  
              <small *ngIf="formErrors.empName" class="text-danger">
                {{ formErrors.empName }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  <strong class="text-danger">*</strong>
                  Mobile No.
                </ion-label>
    
                <ion-input id="mobileNumber" type="number" inputmode="number" class="custom-font" formControlName="mobileNumber"></ion-input>
              </ion-item>
  
              <small *ngIf="formErrors.mobileNumber" class="text-danger">
                {{ formErrors.mobileNumber }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="stacked">
                  <ion-text>
                    <strong class="text-danger">*</strong>
                    Working Days
                  </ion-text>
                </ion-label>
  
                <ion-select placeholder="Select working day(s)" id="workingDays" multiple="true" formControlName="workingDays" class="custom-font">
                  <ion-select-option *ngFor="let day of workingDays" value="{{ day | lowercase }}">
                    <ion-text>{{ day }}</ion-text>
                  </ion-select-option>
                </ion-select>
              </ion-item>  
  
              <small *ngIf="formErrors.workingDays" class="text-danger">
                {{ formErrors.workingDays }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  <strong class="text-danger">*</strong>
                  In Time:
                </ion-label>
  
                <ion-datetime pickerFormat="HH:mm a" displayFormat="hh:mm a" formControlName="inTime" class="custom-font" hourValues="6,7,8,9,10,11,12"></ion-datetime>
              </ion-item>  
  
              <small *ngIf="formErrors.inTime" class="text-danger">
                {{ formErrors.inTime }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  <strong class="text-danger">*</strong>
                  Out Time:
                </ion-label>
  
                <ion-datetime pickerFormat="HH:mm" displayFormat="hh:mm a" formControlName="outTime" class="custom-font" hourValues="13,14,15,16,17,18,19,20,21,22,23"></ion-datetime>
              </ion-item>  
  
              <small *ngIf="formErrors.outTime" class="text-danger">
                {{ formErrors.outTime }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="stacked">
                  <strong class="text-danger">*</strong>
                  Salary Type
                </ion-label>
    
                <ion-select placeholder="Select a salary type" id="salaryType" type="text" inputmode="text" class="custom-font" formControlName="salaryType">
                  <ion-select-option *ngFor="let type of salaryTypes" value="{{ type | lowercase }}">
                    {{ type }}
                  </ion-select-option>
                </ion-select>
              </ion-item>
  
              <small *ngIf="formErrors.salaryType" class="text-danger">
                {{ formErrors.salaryType }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  <strong class="text-danger">*</strong>
                  Salary Amount (Rs.)
                </ion-label>
    
                <ion-input id="salaryAmount" type="number" inputmode="decimal" class="custom-font" formControlName="salaryAmount"></ion-input>
              </ion-item>
  
              <small *ngIf="formErrors.salaryAmount" class="text-danger">
                {{ formErrors.salaryAmount }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  Date of Joining
                </ion-label>
  
                <ion-datetime pickerFormat="MMM DD, YYYY" displayFormat="MMM DD, YYYY" max="{{ maxJoiningDate }}" id="joiningDate" class="custom-font" formControlName="joiningDate"></ion-datetime>
              </ion-item>
  
              <small *ngIf="formErrors.joiningDate" class="text-danger">
                {{ formErrors.joiningDate }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  <strong class="text-danger">*</strong>
                  Username
                </ion-label>
    
                <ion-input id="username" type="text" inputmode="text" class="custom-font" formControlName="username"></ion-input>
              </ion-item>
  
              <small *ngIf="formErrors.username" class="text-danger">
                {{ formErrors.username }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="floating">
                  <strong class="text-danger">*</strong>
                  Password
                </ion-label>
    
                <ion-input id="password" type="password" inputmode="text" class="custom-font" formControlName="password"></ion-input>
              </ion-item>
  
              <small *ngIf="formErrors.password" class="text-danger">
                {{ formErrors.password }}
              </small>
            </ion-col>
  
            <ion-col size-xs="12" size-sm="12" size-md="3">
              <ion-item>
                <ion-label color="primary" position="stacked">
                  Photo Upload
                </ion-label>
    
                <input id="photoImg" type="file" accept="image/jpg,image/jpeg,image/png" class="custom-font" formControlName="photoImg" (change)="onImageSelected($event, 'photoImg')">
              </ion-item>
  
              <small *ngIf="formErrors.photoImg" class="text-danger">
                {{ formErrors.photoImg }}
              </small>
            </ion-col>
  
          </ion-row>
        </form>

      </ion-col>
    </ion-row>

    <hr>

    <!-- Company details -->
    <ion-row>
      <ion-col size="12">
        <ion-text color="primary">
          <small><strong>Company Details:</strong></small>
        </ion-text>
      </ion-col>

      <!-- Map -->
      <ion-col size-xs="12" size-sm="12" size-md="6">
        <ion-item lines="none" class="mb-2">
          <ion-input type="text" inputmode="text" placeholder="Search by address..." autocapitalize="on" [(ngModel)]="locationAddress"></ion-input>

          <ion-button mode="ios" strong="true" fill="clear" shape="round" size="medium" [disabled]="!locationAddress" (click)="getLocationByAddress()">
            <ion-icon slot="icon-only" size="medium" name="search-outline"></ion-icon>
          </ion-button>
        </ion-item>
        
        <div class="embed-responsive embed-responsive-16by9">
          <iframe class="embed-responsive-item" [src]="googleMapsURL"></iframe>

          <ion-button class="m-2" mode="ios" size="large" (click)="getLocation()" color="primary">
            <ion-icon slot="icon-only" name="location-outline" size="large"></ion-icon>
          </ion-button>
        </div>
      </ion-col>

      <!-- Company details form -->
      <ion-col size-xs="12" size-sm="12" size-md="6">
        <form novalidate [formGroup]="addCompanyForm" class="w-100">
          <ion-row>
            <ion-col size="12">
              <ion-item>
                <ion-label color="primary" position="floating" for="companyName">
                  <strong class="text-danger">*</strong>
                  Company Name
                </ion-label>

                <ion-input id="companyName" type="text" inputmode="text" formControlName="companyName" autocapitalize="on"></ion-input>
              </ion-item>

              <small class="text-danger" *ngIf="formErrors.companyName">
                {{ formErrors.companyName }}
              </small>
            </ion-col>

            <ion-col size="12">
              <ion-item>
                <ion-label color="primary" position="floating" for="companyAddress">
                  <strong class="text-danger">*</strong>
                  Company Address
                </ion-label>

                <ion-textarea id="companyAddress" formControlName="companyAddress" autocapitalize="on"></ion-textarea>
              </ion-item>

              <small *ngIf="formErrors.companyAddress" class="text-danger">
                {{ formErrors.companyAddress }}
              </small>
            </ion-col>

            <ion-col size="12">
              <ion-item>
                <ion-label color="primary" position="floating" for="branchName">
                  <strong class="text-danger">*</strong>
                  Branch Name
                </ion-label>

                <ion-input id="branchName" type="text" inputmode="text" formControlName="branchName" autocapitalize="on"></ion-input>
              </ion-item>

              <small *ngIf="formErrors.branchName" class="text-danger">
                {{ formErrors.branchName }}
              </small>
            </ion-col>
          
          </ion-row>
          
        </form>
      </ion-col>
    </ion-row>

    <!-- Submit and reset buttons -->
    <ion-row>
      <ion-col size="6">
        <ion-button color="primary" mode="ios" expand="block" type="button" size="medium" strong="true" [disabled]="!(registerUserForm.valid && addCompanyForm.valid)" (click)="registerUser()">
          <ion-icon slot="start" name="person-add-outline" size="medium"></ion-icon>
          Register
        </ion-button>
      </ion-col>

      <ion-col size="6">
        <ion-button color="primary" mode="ios" expand="block" size="medium" strong="true" (click)="resetAddUserAndAddCompanyForm()">
          <ion-icon slot="start" name="refresh-circle-outline" size="medium"></ion-icon>
          Reset Form
        </ion-button>
      </ion-col>
    </ion-row>

  </ion-grid>

</ion-content>